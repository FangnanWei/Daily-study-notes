## 信号重采样  
[[信号的抽取与插值]]
[重采样](https://shichaog1.gitbooks.io/hand-book-of-speech-enhancement-and-recognition/content/chapter2.html#)  

[webrtc重采样](https://xjsxjtu.github.io/2017-07-08/LearningWebRTC-audio_resample/)  


假设信号x(t)x(t)是连续时间信号，则以t=nTst=nTs为间隔对信号x(t)x(t)采样,采样后信号为x(nTs)x(nTs)，nn是整数, TsTs是采样周期,根据奈奎斯特采样定理，当x(t)x(t)是带限信号，且其频带范围在±Fs2±Fs2之间，这时采样不会导致频谱混跌，采样率Fs=1TsFs=1Ts,设x(ω)x(ω)是x(t)x(t)的傅里叶变换，则有X(ω)=∫+∞−∞x(t)e−jωtdtX(ω)=∫−∞+∞x(t)e−jωtdt，可以假定:  
X(ω)=0,|ω|≥πFsX(ω)=0,|ω|≥πFs  
根据香龙定理，由x(nTs)x(nTs)重构x(t)x(t)的公式如下：

x^(t)≜∑n=−∞∞x(nTs)hs(t−nTs)≡x(t)(1)(1)x^(t)≜∑n=−∞∞x(nTs)hs(t−nTs)≡x(t)

其中，

hs(t)≜sinc(Fst)≜sin(πFst)πFst(2)(2)hs(t)≜sinc(Fst)≜sin(πFst)πFst

以下讨论x(t)x(t)在(F′s=1T′sFs′=1Ts′)，仅讨论方程2.1是整数倍情况下的T′sTs′。  
当新的采样率Fs′Fs′小于原始采样率FsFs时，低通滤波截止频率必须是新采样率的二分之一，即F′s2Fs′2。对于理想的低通滤波器，则有：

h(t)=min{1,F′s/Fs}sinc(min{Fs,F′s}t)(3)(3)h(t)=min{1,Fs′/Fs}sinc(min{Fs,Fs′}t)

公式的前面增益因子是为了保持通带内单位增益。  
sincsinc函数sinc(t)≜sin(πt)πtsinc(t)≜sin(πt)πt的波形如下:

![图1 sinc函数波形](https://shichaog1.gitbooks.io/hand-book-of-speech-enhancement-and-recognition/content/assets/sinc.png)

图1 sinc函数波形

公式1用卷积公式表示为:x∗hs(t)x∗hs(t)。  
该卷积过程可以看成是sinc函数的平移叠加，每个sinc函数对应于一个采样点,并且幅度被采样点调制过，所有sinc函数加在一起是原始信号。sin(z)sin(z)值为零的地方位于整数处(除z=0z=0)。这意味着t=nTst=nTs时刻(对应于一个采样点)，为和的唯一贡献是采样信号x(nTs)x(nTs)。  
sincsinc函数是理想低通滤波器，实际使用时会进行加窗处理。  
## sinc重采样

开源语音处理算法speex使用了sinc函数方法，窗函数是凯撒窗。  
以整数因子抽取(麦克风采样率为48KHz，ASR的声学特征提取信号的采样率是16KHz)为例来说明算法的实现过程。设x(n)x(n)是对模拟信号xa(t)xa(t)以奈奎斯特采样率FxFx采样得到的信号，其频谱为X(ejω)X(ejω)，则在频率区间0≤|ω|≤π0≤|ω|≤π(对应的模拟频率是|f|≤Fx2Hz|f|≤Fx2Hz)，X(ejω)X(ejω)是非零的。现在按整数倍D对x(n)x(n)进行抽取。**为了避免频谱混跌，必须先对x(n)x(n)进行抗混跌低通滤波**，**将x(n)x(n)的有效频带限制在折叠频率Fx2DHzFx2DHz以内，等效的数字频率为π/Dπ/D弧度以内。**

对x(n)x(n)按整数倍因子DD进行抽取，得到信号y(m)y(m)。其原理框图如下:  
![图2 整数因子D抽取原理框图](https://shichaog1.gitbooks.io/hand-book-of-speech-enhancement-and-recognition/content/assets/down_sample.png)