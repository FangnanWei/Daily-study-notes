# 简介
## 理想二值掩蔽IBM
理想二值掩蔽IBM解决语音增强（分离）问题。理想二值掩蔽，其中掩蔽广泛
用于图像处理之中，具体到语音增强领域是指对选定的时频区域进行遮挡
以控制要处理的区域，二值则是对每个时频点量化的精度非阰即阱，理想二
值掩蔽的含义则是根据纯净语音和噪声之间的能量关系，将语音能量占主
导的时频点标记为1，噪声能量占主导的时频点标记为0，由此得到一个滤
波器，对带噪特征进行滤波，在语音时频稀疏性假设下留下的即使语音成
分
## 理想比值掩蔽IRM、相位敏感掩蔽PSM
理想比值掩蔽IRM、相位敏感掩蔽PSM等训练目标也明显受到了传统语音增
强统计模型的影响，这类掩蔽估计由于其定义也不再能被视为分类问题阨而
同样是回归问题阩。这类掩蔽本质上是在设计某种意义上最优的滤波器，毕
竟，回顾IBM的介绍**IBM的含义正是根据每个时频点上语音和噪声之间的能
量关系，将语音能量占主导的时频点标记为1，噪声能量占主导的时频点标
记为0 中主导阑二字充满了不安全感**。一个极端的例子是，在极低信噪比情
况下IBM降会出现非常多的阰值导致理想掩蔽的滤波结果的语音质量和可懂度
都会十分糟糕。IBM的硬分类变成了一种软分类，每个时频点的滤波
器系数定义为语音能量和语音噪声二者能量之和的比值。熟悉传统语音增强
算法的读者不难发现，这个定义和频域维纳滤波算法尽管并不相同但还是十
分相像。
## 分类 mask mapping
从训练目标角度将上述两大类工作分别
定义为基于掩蔽mask和基于谱映射mapping的算法用于分
类，这种分类方式得到了广泛地接受。

熟悉**图像分割**的读者应该已经感受到了**语音增强与图像分割**的相似之
处，因此卷积神经网络的引入也十分自然。不过在介绍卷积神经网络在语音
增强的应用之前，有必要至少提一点语音增强与图像分割的区别，尽管我们
可以将语音特征看成一张图片，但是由于语音增强有很多实时应用场景，因
此在这张阐图片阑时间维度的处理需要十分谨慎阐实时陷阱阑。卷积层由于阐局部
连接、权重共享阑的特点相比全连接层和循环层拥有更少的参数

基于深度学习语音增强的性能第一次遇到了瓶颈。当然人们很快
意识到了问题阖阖这一性能限制是只进行幅度谱估计带来的，**相位恢复**似乎
对人耳感知是重要的。以至于解决该问题的方案出现得如此之快在今天看来
似乎并没有瓶颈的意味在。在相位恢复重要性思潮下，用于同时进行幅度估
计和相位恢复的方案大方向上可以分为时域的方案和谱域的方案。不论是
哪种方案他们都是为了解决由于相位谱没有清晰的模式结构导致其不易优
化的问题。
## 时域
首先介绍**时域**模型，原因依旧是因为介绍起来可以比较简略。
时域模型的兴起主要由于其在**语音分离**领域大获成功，以一种**波形到波形
的映射方式**提供了一种解决相位谱不易优化问题的方案**放弃建模相位**。
不过也许是由于噪声模式的复杂性，抑或是房间冲激响应的敏感多变，时
域模型在噪声混响场景下的性能和鲁棒性使其在语音增强中并不能成为主
流。网络结构上和之前的幅度谱架构基本还是类似的，有卷积编解码器结构
也有卷积循环或TCN网络，只不过对应的卷积层大多用一维卷积代替了二维卷积当然也同样有使用二维卷积作为编解码器的架构。
## 频域
相比之下，谱域的方案解决相位估计的方式则略显复杂 。众所周知，复数可以由幅度相位
表示也可以由实部虚部表示。其中实部虚部表示和之前幅度谱模型一样，
主要分为基于掩蔽和基于谱映射的方式
2016年提出一种复数比值掩蔽CIRM 2019年将CRN应用到复数谱映射直接利用网
络估计增强语音的实部和虚部 2019年提出基于极坐标系的复值掩蔽策略pcRM 西工大DCCRN
然而本篇文章对于在不同损失函数情况下的几种典型复值掩蔽的分析可能更加有
趣
但其提供的幅度估计和相位估计的补偿作用无疑为解耦风格工作有效性提
供了一种合理解释。所谓幅度和相位估计的补偿作用，是指在迫使网络输
出**逼近理想复数谱时，幅度谱估计的准确度会大打折扣**
一个解决幅度
相位估计补偿作用的想法是，将复数谱的优化问题解耦为**幅度初估计和包
括相位信息在内的阐全信息阑估计两部分**。尽管这仍属于复数谱估计的一类方
法，然而这类算法在近年来备受关注且性能优异，2020年，先后利用两次信号
变换，**首先利用STFT幅度谱上进行幅度估计而后再利用一维卷积生成**
的可学习的分析/合成基函数直接将语音时域波形映射到高维空间进行语音
和噪声成分的分离，利用时域模型的方式完成相位恢复 2021年声学所提出一种完全在STFT域进行先后完成幅度谱估计和复数谱残差修正的框架，利用复数谱残差修复相位信息。完全在STFT域上处理两部分任务的一个好处是，原本级联的两个子任务出现了并行优化的可能
西工大分别提出了幅度估计和复数谱修正的两种并行架构。其实，从复数谱的角度考虑，这种解耦是由于幅度相位估计的补偿作用导致幅度谱估计不准确造成的，因此，除了首先
约束幅度谱后再根据相位差微调增强结果，也可以先得到复数谱结果后补偿
不准确的幅度信息。
2018年，rnnoise利用信号处理方法进行基频滤波抑制谐波间噪声残留，2020年，percpenet提出估计包络增益因子外利用网络估计深度滤波器(deep filtering)系数
## 损失函数
### 基于距离的损失函数
基于范数 的损失函数Lp损失，MAE平均绝对误差，MSE均方误差。
可以比较掩蔽的损失函数，rnnoise提出一种幂律压缩的掩蔽MSE，带个指数项，控制噪声抑制的激进程度。
基于信号近似SA比直接比较掩蔽好一点，即将掩蔽乘到带噪语音上
复数谱范数常与幅度损失结合
### 基于能量比的损失函数
SDR,SI-SDR
### 指标
PESQ之类的，不常用

# 幅度谱
## 掩蔽
输入特征不仅可以是对数功率谱，幅度谱、mel谱，bark谱等都曾作为输入特征

IRM理想比值掩蔽定义的形式上与维纳滤波器完全一致，但维纳滤波是基于统计的线性滤波器，式中
## 映射
CRN-causal

# 复数谱
由于各时频点的相位在时间轴和频率轴上都变化迅速，由于相位缠绕问题，语谱各时频点的相位几乎均匀分布在-𝜋-𝜋之间。相位谱并不存在一个清晰的结构模式，这使得模型学习更加困难。
而采用复数谱的实部和虚部的则于幅度谱有类似结构。
## 分类
构造值数掩蔽，直接复数谱映射，估计幅度相位分量
复值掩蔽按坐标系分为**笛卡尔坐标系**下的时频掩蔽和**极坐标**下的时频掩蔽
## 复数谱映射
将单通道变为多通道。
直接将实部和虚部特征沿着特征通道拼接是否合理，换言之，实部和虚部是否应该单独的编码和预测
GCRN:单独的编码器编码实部和虚部，而后使用两个解码器分别估计增强的实部和虚部
带噪语谱的实部和虚部沿特征通道维拼接后送入一个编码器，编码后的高维特征经LSTM进行建模后作为两个解码器的输入，两个解码器分别估计得到增强
语谱的实部和虚部
LSTM引入分组机制
## 笛卡尔系的复值掩蔽
利用神经网络直接估计实部掩蔽和虚部掩蔽，而后将估计的掩蔽于带噪复数谱按复数乘法相乘进行滤波
具体看pdf27页
DPCRN，由编码器，DPRNN构成的时序建模和解码器组成，编解码器与GCRN相似

CRUSE

## deep filter
处理针对当前时频点的复值掩蔽，利用当前时频点相邻时频点进行滤波求和计算得到当前时频点谱估计的深度滤波
即指利用相同频率的当前帧和历史帧信息进行滤波，而不使用相邻频点信息

## 极坐标系
复值掩蔽可视为对每个时频点幅度的放缩和相位的旋转
DCCRN

# 混合式语音增强
在传统的基于统计模型基础上，利用神经网络实现先验信噪比的估计
基于统计模型的
语音增强算法的增益因子往往由先验和后验信噪比决定，而后验信噪比可以
通过判决引导DD算法从先验信噪比中估计得到。因此，
先验信噪比的估计是这类算法的核心由于传统先验信噪比估计算法面对
高度非平稳噪声缺乏良好的跟踪能力，神经网络被用于代替对应的传统模
块以实现不对噪声和语音特性进行假设的、能够迅速响应噪声特性变化的
先验信噪比估计
## RNNOISE PERCEPNET
收到了语音编码的影响，将语谱分解为语谱包络和语谱细节（激励）两个部分。
语音的包络由声道形状的变化，语谱细节由声带的准周期性震动产生，主要是基频及其谐波
根据人耳听觉感知机制，语谱包络可以在某种听觉感知相关的低分辨率频带，我们可以通过计算增益函数得到增强语音的谱包络，此时的谱包络在浊音段仍是粗糙的，而在其他段则与纯净语谱听感上相似
语谱细节也就是基频及其谐波阖阖可以通过基频滤波进行修正，抑制掉谐波间的噪声，此时应在高分辨率的STFT谱或时域上进行，主要包括两部
首先利用梳状滤波器得到滤波后的语谱P，然后
根据网络估计的基频滤波强度𝑟加权组合带噪谱成分和滤波信号谱成分以增
加语音的自然度Z=(1-r)*X+r*P 
其中特征提取，神经网络，包络后滤波承担了**语谱包络**估计任务，分别用于变换到低分辨率的ERB频带、估计谱包络增益函数和通过增益补偿和加混响改善听感
神经网络和基频滤波承担**语谱细节**估计任务分别用于估计基频滤波强度和基频滤波

RNNOISE试图按照谱减法框架设计RNN完成谱包络修正，
PERCEPNET则直接使用多任务CRN同时估计谱包络增益因子和基频滤波强度系数

## GAN
此外，或许带噪语音和纯净语音的高度相似性也是GAN在语音增强领域没有再现其在图像生成

# 基于解耦的语音增强

## 基于谱包络-周期性语音成分解耦的语音增强方法
继承自RNNOISE的算法得到进一步发展。在遵循将语谱分解为包络和细节两部分的解耦原则下
将用于修复谱细节以增强谐
波成分的基频滤波阶段通过神经网络实现与PERCEPNET类似，首先利用神
经网络估计ERB尺度的增益函数，经过插值后对频域的谱包络进行滤波。后，第二阶段通过网络估计低频部分的复值滤波器系数，通过deep filter [[#deep filter]]操作实现对低频周期性语音成分的谐波进行增强的目的
