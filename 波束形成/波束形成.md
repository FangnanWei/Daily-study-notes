# MVDR

MVDR中文名字叫**最小均方无畸变响应**，**最小方差无失真响应**它的精髓就体现在无畸变上。什么叫无畸变呢，就是在对感兴趣方位（声源方向）的信号无失真地输出，这意味着该算法可以直接当做语音后端算法(如ASR)的前处理过程。MVDR波束形成器的公式推导并不复杂，我们这里简单的介绍一下。MVDR由Capon于1969年提出，也称为Capon波束形成器，它的目标是对感兴趣方位的信号无失真输出的同时使波束输出的噪声方差最小。波束输出噪声方差记为

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhcTCxapPSsCvtbS6aPeErGyrUCfzyq1wroiaJ82TjOsKUx8m0m8urXZ0EMNgHSnyLgbNnnN3xpccSQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

其中**w**是加权向量，**Rn**是噪声的协方差矩阵。于是MVDR可以描述为

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhcTCxapPSsCvtbS6aPeErGyI4gTUOTC4vWCkVc2xgC2kjAMcT03px2uefqdicwGLuf4P9blIx92pMg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

采用拉格朗日算子，对上述有约束的优化问题进行求解，定义函数  

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/R3j7FT5mhhcTCxapPSsCvtbS6aPeErGyibFXS3TicEJd19t49TEoibya5OOnStglQbnu047ibL3cnWX7iapC7LqJvYQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

对**w**求导，并令其导数为**0**有  

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhcTCxapPSsCvtbS6aPeErGy3p2FeEy59ZibM6b5QRGoRoSKuAygJt5JLFTgHZ5SZryRQBnGt1xfBHg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

代入公式（2）中的约束条件得到

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhfuv2hzIfibxChkeKLDt76CWxeKAXsuC57hMfLiayyN0y3I7XCYcnhYLsXgtJOhFmUGMPUhCTfsQboA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

把公式（5）代入公式（4）解得MVDR的权重为

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhfuv2hzIfibxChkeKLDt76CWLJS4cgBzgibc5fIjJnhoPrwa3MYHU8OTAicK3dhmKVGIuibiaG3f0ricTSw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

若噪声场为空间白噪声，那么MVDR退化成常规波束成形。公式（6）的权重计算需要知道噪声的协方差矩阵，但有时无法估计出噪声的协方差矩阵，直接使用接受数据的协方差矩阵进行计算，即  

![图片](https://mmbiz.qpic.cn/mmbiz_png/R3j7FT5mhhfuv2hzIfibxChkeKLDt76CWNOGgTZmSsgITUzFK6DdSATFvdE8bzmKFcnRiatrJOdlHtmsp8kCPBMQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

有的地方称上式的波束形成器为最小功率无失真响应（Minimum Power Distortionless Response, MPDR）。MVDR的效果依赖于导向矢量和数据接受协方差矩阵精确与否，在理想环境下能够抑制干扰，最大程度提升信干噪比。

### [mvdr](https://www.funcwj.cn/2020/01/13/intro-on-se-and-ss/)

![image](https://cdn.staticaly.com/gh/andyye1999/image-hosting@master/20221011/image.5s0w5jkm9ic0.webp)


### [Overview of Beamformer](https://www.funcwj.cn/2017/11/11/overview-of-beamformer/)

![QQ截图20221011203113](https://cdn.staticaly.com/gh/andyye1999/image-hosting@master/20221011/QQ截图20221011203113.5p0397nrs7s0.webp)

